---
title: "Learn R Part II In-class Exercises"
format: html
editor: visual
---

Welcome to Quarto! This is where you will try out all of the hands-on exercises in the workshop. Begin by running these first two code chunks:

```{r}
# load packages
library(tidyverse)
```

```{r}
# load data
bowie <- read_csv("data/david_bowie_spotify.csv")
nat_parks <- read_csv("data/nat_parks_visitors.csv")
```

## 00. Quick review

Using an `if_else()` statement, create a new variable in `bowie` that indicates if a song is "long" or "short". Name the variable `long_short`.

Songs are considered "long" if `duration_sec` is greater than 250.

```{r}
# add a new long_short variable
bowie <- bowie |> 
  mutate(long_short = if_else(duration_sec > 250,
                              "long",
                              "short"))
```

## 01. How do I aggregate by collapsing?

Using `group_by()` and `summarise()`, calculate average `danceability` by `long_short`.

On average, are David Bowie's longer or shorter songs more "danceable"?

```{r}
# collapse by long_short
bowie |> 
  group_by(long_short) |> 
  summarise(avg_dance = mean(danceability))
```

*On average, David Bowie's shorter songs are slightly more danceable than his longer songs (.52 vs. .50)*

## 02. How do I aggregate *without* collapsing?

Alter the `bowie` data frame to add a variable that calculates average `tempo` by `album` (without collapsing).

Bonus: Can you determine if the tempo of the song "Changes" is higher or lower than the "Hunky Dory" album average?

```{r}
# calculate average tempo by album (no collapse)
bowie <- bowie |> 
  group_by(album) |> 
  mutate(avg_tempo = mean(tempo))

# bonus: find Changes and compare to album average
bowie |> 
  select(track, album, tempo, avg_tempo) |> 
  filter(track == "Changes")
```

*The song "Changes" has a lower tempo than the "Hunky Dory" album average (113 vs. 119).*

## 03. How do I tidy data?

Pivot the `nat_parks` data frame longer so that year and visitors each make a column.

Hint: Pivot the year columns only. To specify them, you can use either of these structures:

`cols = start:stop`

`cols = -c(column1, column2`)

```{r}
# pivot years longer
nat_parks_long <- nat_parks |> 
  pivot_longer(cols = -c(park, state),
               names_to = "year",
               values_to = "visitors")
```
